# wp-bedrock

![Version: 0.1.0](https://img.shields.io/badge/Version-0.1.0-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 1.16.0](https://img.shields.io/badge/AppVersion-1.16.0-informational?style=flat-square)

A Helm chart for Bedrock, a Wordpress boilerplate

## Installation

### Add Helm repository

```shell
helm repo add sebastiaankok https://sebastiaankok.github.io/helm-charts
helm repo update
```

## Install wp-bedrock chart

Using config from a file:

```bash
helm install --generate-name sebastiaankok/wp-bedrock -f values.yaml
```

## Requirements

| Repository | Name | Version |
|------------|------|---------|
| https://charts.bitnami.com/bitnami | mariadb | ~9.3.11 |

## Configuration

The following table lists the configurable parameters of the chart and the default values.

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| replicaCount | int | `1` | Set replica count |
| image.nginx | string | `"nginxinc/nginx-unprivileged:1.20-alpine"` | Nginx frontend container image |
| image.repository | string | `"registry.gitlab.com/sebastiaankok/wp-bedrock-example"` | Bedrock image, see example at registry.gitlab.com/sebastiaankok/wp-bedrock-example |
| image.pullPolicy | string | `"IfNotPresent"` |  |
| image.tag | string | `"latest"` |  |
| imagePullSecrets | list | `[]` |  |
| nameOverride | string | `""` |  |
| fullnameOverride | string | `""` |  |
| mariadb.enabled | bool | `true` | Enable bitnami mariadb helm chart |
| mariadb.auth.database | string | `"bedrock"` | Database name |
| mariadb.auth.username | string | `"bedrock_user"` | Database user |
| mariadb.auth.existingSecret | string | `""` | Use existing secret. The secret has to contain the keys mariadb-root-password, mariadb-replication-password and mariadb-password  |
| mariadb.auth.password | string | `""` | Database user password, if empty generated by helm |
| mariadb.auth.rootPassword | string | `""` | Database root password, if empty generated by helm |
| extraYaml | string | `""` | Add extra yaml. usage: extraYaml: |  ...  |
| service.type | string | `"ClusterIP"` |  |
| service.port | int | `8081` | The nginx container is configured to expose http on port 8081 |
| ingress.enabled | bool | `false` |  |
| ingress.annotations | object | `{}` |  |
| ingress.hosts[0].host | string | `"chart-example.local"` |  |
| ingress.hosts[0].paths[0].path | string | `"/"` |  |
| ingress.tls | list | `[]` |  |
| persistence.enabled | bool | `false` | Create PVC for wp-content/upload directory |
| persistence.size | string | `"2Gi"` | PVC storage size  |
| persistence.storageClass | string | `""` | configure specific storageClass  |
| persistence.accessMode | string | `"ReadWriteMany"` | ReadWriteMany is required when scaling multiple replica's |
| env.WP_HOME | string | `"http://chart-example.local"` | Define WP_HOME variable |
| env.WP_SITEURL | string | `"http://chart-example.local/wp"` | Define WP_SITEURL variable |
| env.WP_ENV | string | `""` | Set WP_ENV to development to enable debug logging |
| nginxSettings.cacheEnabled | bool | `false` | Enable nginx fastcgi cache. Install a wordpress nginx plugin for clearing cache. |
| nginxSettings.cacheInactiveMin | int | `10` | Delete inactive cache time in minutes |
| nginxSettings.cacheSizeMiB | int | `50` | Cache max size in MiB |
| saltSecrets | string | `""` | Name of Kubernetes secrets that must contain keys: AUTH_KEY, AUTH_SALT LOGGED_IN_KEY, LOGGED_IN_SALT, NONCE_KEY, NONCE_SALT, SECURE_AUTH_KEY, SECURE_AUTH_SALT  |
| resources | object | `{}` |  |
| autoscaling.enabled | bool | `false` |  |
| autoscaling.minReplicas | int | `1` |  |
| autoscaling.maxReplicas | int | `100` |  |
| autoscaling.targetCPUUtilizationPercentage | int | `80` |  |
| nodeSelector | object | `{}` |  |
| tolerations | list | `[]` |  |
| affinity | object | `{}` |  |
| serviceAccount.create | bool | `true` |  |
| serviceAccount.annotations | object | `{}` |  |
| serviceAccount.name | string | `""` |  |
| podAnnotations | object | `{}` |  |
| podSecurityContext | object | `{}` |  |
| securityContext | object | `{}` |  |
